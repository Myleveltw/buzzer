<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Moderator</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
margin:0;background:#000;color:white;font-family:Arial;
display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh
}
#img{max-height:60vh;display:none;margin-bottom:20px}
#winner{font-size:60px;display:none;margin-top:20px}
</style>
</head>

<body>

<img id="img">
<h1 id="status">Bereit</h1>
<div id="winner"></div>

<audio id="audio"></audio>

<script>
const firebaseConfig={
databaseURL:"https://wsmds-9a390-default-rtdb.europe-west1.firebasedatabase.app/"
};
firebase.initializeApp(firebaseConfig);

const db=firebase.database();
const settings=db.ref("settings");
const buzzer=db.ref("buzzer");

const img=document.getElementById("img");
const audio=document.getElementById("audio");
const status=document.getElementById("status");
const winner=document.getElementById("winner");

settings.on("value",snap=>{
const s=snap.val();
if(!s)return;

img.style.display="none";
audio.pause(); audio.currentTime=0;

if(s.mode==="buzzer"){
status.textContent="ðŸ”´ Buzzer bereit";
}

if(s.mode==="image" && s.image){
img.src=s.image;
img.style.display="block";
status.textContent="ðŸ–¼ï¸ Bild aktiv";
}

if(s.mode==="audio" && s.audio){
audio.src=s.audio;
audio.play();
status.textContent="ðŸ”Š Audio lÃ¤uft";
}

winner.style.display="none";
});

buzzer.on("value",snap=>{
const b=snap.val();
if(!b)return;

audio.pause();
img.style.display="none";

winner.style.display="block";
winner.textContent=b.name+" war zuerst!";
});
</script>

</body>
</html>
